# çŸ¥è¯†ä»˜è´¹è§†é¢‘ H5 å…¨æ ˆåº”ç”¨

åŸºäº Vue3 + Node.js + SQLite çš„çŸ¥è¯†ä»˜è´¹è§†é¢‘ç±» H5 å…¨æ ˆåº”ç”¨ï¼Œæ”¯æŒå¾®ä¿¡ç™»å½•ã€å¾®ä¿¡æ”¯ä»˜ã€è§†é¢‘é˜²ç›—æ’­æ”¾ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## é¡¹ç›®ç‰¹æ€§

- ğŸ¨ **ç°ä»£åŒ–å‰ç«¯**: Vue3 + Vite + Vant UIï¼Œæ”¯æŒç§»åŠ¨ç«¯è‡ªé€‚åº”
- ğŸ” **å®‰å…¨è®¤è¯**: JWT èº«ä»½è®¤è¯ + å¾®ä¿¡ OAuth ç™»å½•
- ğŸ’° **åœ¨çº¿æ”¯ä»˜**: å¾®ä¿¡ H5 æ”¯ä»˜ï¼Œå®Œæ•´çš„è®¢å•æµç¨‹
- ğŸ¬ **è§†é¢‘é˜²ç›—**: é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­ç­¾å URL + åŠ¨æ€æ°´å°
- ğŸ“± **ç§»åŠ¨ç«¯ä¼˜åŒ–**: postcss-px-to-viewport è‡ªåŠ¨é€‚é…
- ğŸ—„ï¸ **è½»é‡æ•°æ®åº“**: SQLite é›¶é…ç½®ï¼Œæ–‡ä»¶å¼å­˜å‚¨
- ğŸš€ **é«˜æ€§èƒ½**: PM2 è¿›ç¨‹å®ˆæŠ¤ + Nginx åå‘ä»£ç†
- ğŸ“¦ **ä¸€é”®éƒ¨ç½²**: å®Œæ•´çš„éƒ¨ç½²è„šæœ¬å’Œæ–‡æ¡£

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- Vue3 + Vite 4.x
- Vant UI 4.x
- Pinia çŠ¶æ€ç®¡ç†
- Vue Router 4.x
- video.js è§†é¢‘æ’­æ”¾
- Axios ç½‘ç»œè¯·æ±‚
- postcss-px-to-viewport é€‚é…

### åç«¯
- Node.js + Express
- SQLite + Sequelize ORM
- JWT èº«ä»½è®¤è¯
- Joi å‚æ•°æ ¡éªŒ
- é˜¿é‡Œäº‘ OSS + è§†é¢‘ç‚¹æ’­
- å¾®ä¿¡ H5 æ”¯ä»˜

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0

### æœ¬åœ°å¼€å‘

1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-repo/knowledge-payment.git
cd knowledge-payment
```

2. å®‰è£…ä¾èµ–
```bash
cd frontend && npm install
cd ../backend && npm install
```

3. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å‰ç«¯é…ç½®
cd frontend
cp .env.development.example .env.development
# ä¿®æ”¹ .env.development ä¸­çš„é…ç½®

# åç«¯é…ç½®
cd ../backend
cp .env.example .env
# ä¿®æ”¹ .env ä¸­çš„é…ç½®
```

4. åˆå§‹åŒ–æ•°æ®åº“
```bash
cd backend
npm run init-db
```

5. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨åç«¯
cd backend
npm run dev

# å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend
npm run dev
```

è®¿é—®ï¼š
- å‰ç«¯: http://localhost:3000
- åç«¯: http://localhost:5000

## é¡¹ç›®ç»“æ„

```
knowledge-payment/
â”œâ”€â”€ frontend/              # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/         # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ components/   # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/      # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ stores/      # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ views/       # é¡µé¢ç»„ä»¶
â”‚   â”‚   â””â”€â”€ styles/      # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ .env.development
â”‚   â”œâ”€â”€ .env.test
â”‚   â”œâ”€â”€ .env.production
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ backend/               # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ config/            # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ controllers/       # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±
â”‚   â”œâ”€â”€ middlewares/       # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ scripts/           # è„šæœ¬
â”‚   â”œâ”€â”€ .env
â”‚   â”œâ”€â”€ app.js
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ ecosystem.config.js
â”œâ”€â”€ deploy/                # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh
â”‚   â”œâ”€â”€ backup.sh
â”‚   â””â”€â”€ nginx.conf
â””â”€â”€ docs/                  # æ–‡æ¡£
    â”œâ”€â”€ DEVELOPMENT.md
    â””â”€â”€ DEPLOYMENT.md
```

## æ ¸å¿ƒåŠŸèƒ½

### å¾®ä¿¡ç™»å½•
- å¾®ä¿¡ OAuth æˆæƒ
- JWT Token è®¤è¯
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†

### è§†é¢‘æ’­æ”¾
- é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­é›†æˆ
- ç­¾å URL é˜²ç›—é“¾
- åŠ¨æ€æ°´å°ä¿æŠ¤
- æ’­æ”¾è¿›åº¦è®°å¿†
- è¯•çœ‹åŠŸèƒ½ï¼ˆ3åˆ†é’Ÿï¼‰

### åœ¨çº¿æ”¯ä»˜
- å¾®ä¿¡ H5 æ”¯ä»˜
- è®¢å•åˆ›å»ºä¸ç®¡ç†
- ä¼˜æƒ åˆ¸ç³»ç»Ÿ
- æ”¯ä»˜å›è°ƒå¤„ç†

### ä¸ªäººä¸­å¿ƒ
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- å·²è´­è¯¾ç¨‹åˆ—è¡¨
- è§‚çœ‹å†å²è®°å½•
- ä¼˜æƒ åˆ¸ç®¡ç†

## æ¥å£æ–‡æ¡£

### ç”¨æˆ·æ¨¡å—
- `POST /api/users/wxlogin` - å¾®ä¿¡ç™»å½•
- `GET /api/users/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /api/users/profile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `GET /api/users/purchased` - è·å–å·²è´­è¯¾ç¨‹
- `GET /api/users/history` - è·å–è§‚çœ‹å†å²
- `GET /api/users/coupons` - è·å–ä¼˜æƒ åˆ¸
- `GET /api/users/check-course/:id` - æ£€æŸ¥è¯¾ç¨‹æƒé™

### è¯¾ç¨‹æ¨¡å—
- `GET /api/home` - è·å–é¦–é¡µæ•°æ®
- `GET /api/courses` - è·å–è¯¾ç¨‹åˆ—è¡¨
- `GET /api/courses/:id` - è·å–è¯¾ç¨‹è¯¦æƒ…
- `GET /api/courses/:id/chapters` - è·å–ç« èŠ‚åˆ—è¡¨

### è§†é¢‘æ¨¡å—
- `POST /api/videos/get-sign-url` - è·å–ç­¾åæ’­æ”¾ URL
- `POST /api/videos/save-progress` - ä¿å­˜æ’­æ”¾è¿›åº¦
- `GET /api/videos/progress` - è·å–æ’­æ”¾è¿›åº¦

### æ”¯ä»˜æ¨¡å—
- `POST /api/orders/create` - åˆ›å»ºè®¢å•
- `GET /api/orders/:id` - è·å–è®¢å•è¯¦æƒ…
- `GET /api/orders` - è·å–è®¢å•åˆ—è¡¨
- `POST /api/pay/wxpay` - å‘èµ·å¾®ä¿¡æ”¯ä»˜
- `POST /api/pay/wxpay/callback` - å¾®ä¿¡æ”¯ä»˜å›è°ƒ
- `GET /api/pay/status/:id` - æŸ¥è¯¢è®¢å•çŠ¶æ€

## éƒ¨ç½²æŒ‡å—

è¯¦ç»†éƒ¨ç½²æ–‡æ¡£è¯·å‚è€ƒ [DEPLOYMENT.md](./docs/DEPLOYMENT.md)

### å¿«é€Ÿéƒ¨ç½²

1. é…ç½®æœåŠ¡å™¨ç¯å¢ƒ
2. ä¸Šä¼ é¡¹ç›®ä»£ç 
3. å®‰è£…ä¾èµ–
4. åˆå§‹åŒ–æ•°æ®åº“
5. é…ç½® PM2 å’Œ Nginx
6. é…ç½® HTTPS è¯ä¹¦
7. å¯åŠ¨æœåŠ¡

### ä¸€é”®éƒ¨ç½²è„šæœ¬
```bash
cd deploy
chmod +x deploy.sh
./deploy.sh
```

## å¼€å‘æ–‡æ¡£

è¯¦ç»†å¼€å‘æ–‡æ¡£è¯·å‚è€ƒ [DEVELOPMENT.md](./docs/DEVELOPMENT.md)

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨
- `users` - ç”¨æˆ·è¡¨
- `categories` - åˆ†ç±»è¡¨
- `banners` - è½®æ’­å›¾è¡¨
- `courses` - è¯¾ç¨‹è¡¨
- `chapters` - ç« èŠ‚è¡¨
- `orders` - è®¢å•è¡¨
- `progresses` - æ’­æ”¾è¿›åº¦è¡¨
- `coupons` - ä¼˜æƒ åˆ¸è¡¨

## å¸¸è§é—®é¢˜

### å¾®ä¿¡æˆæƒå¤±è´¥
- æ£€æŸ¥å¾®ä¿¡ AppID å’Œ AppSecret æ˜¯å¦æ­£ç¡®
- ç¡®è®¤æˆæƒåŸŸåå·²åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°é…ç½®
- æ£€æŸ¥æˆæƒå›è°ƒ URL æ˜¯å¦æ­£ç¡®

### è§†é¢‘æ— æ³•æ’­æ”¾
- æ£€æŸ¥é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤è§†é¢‘ ID æ˜¯å¦æœ‰æ•ˆ
- æ£€æŸ¥ç­¾å URL æ˜¯å¦è¿‡æœŸ

### è·¨åŸŸæŠ¥é”™
- æ£€æŸ¥åç«¯ CORS é…ç½®
- ç¡®è®¤å‰ç«¯ API åœ°å€é…ç½®æ­£ç¡®
- æ£€æŸ¥ Nginx åå‘ä»£ç†é…ç½®

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- é‚®ç®±: support@example.com
- æ–‡æ¡£: https://docs.example.com

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- å®Œæˆæ ¸å¿ƒåŠŸèƒ½å¼€å‘
- æ”¯æŒå¾®ä¿¡ç™»å½•å’Œæ”¯ä»˜
- å®ç°è§†é¢‘é˜²ç›—æ’­æ”¾
